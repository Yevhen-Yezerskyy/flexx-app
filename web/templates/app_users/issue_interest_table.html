<!-- FILE: web/templates/app_users/issue_interest_table.html  (обновлено — 2026-02-16)
     PURPOSE: Partial HTML для Stückzinstabelle: если период > 1 года — вывод блоками по годам (3 колонки на блок). -->

<div class="flex items-start gap-4">
  <div class="flex-1">
    <div class="text-lg font-semibold">Stückzinstabelle</div>
    <div class="text-sm text-gray-600 mt-1">
      {{ issue.title }} · EUR {{ issue.bond_price }} · {{ issue.issue_date|date:"d.m.Y" }}
    </div>
  </div>

  <button type="button"
          data-interest-modal-close
          class="underline hover:text-[var(--accent)] transition whitespace-nowrap">
    Schließen
  </button>
</div>

{% for g in groups %}
  {% if g.range_label %}
    <div class="mt-6 text-sm font-semibold text-[var(--text)]">
      {{ g.range_label }}
    </div>
  {% else %}
    <div class="mt-4"></div>
  {% endif %}

  <div class="mt-3 grid grid-cols-3 gap-4">
    {% for col in g.cols %}
      <table class="w-full border border-[var(--text)] text-sm">
        <thead>
          <tr>
            <th class="border border-[var(--text)] px-2 py-2 text-center text-xs font-semibold leading-tight">
              Stückzinsen je Teilschuld-<br>
              verschreibung zu EUR {{ issue.bond_price }}<br>
              in EUR
            </th>
            <th class="border border-[var(--text)] px-2 py-2 text-center text-xs font-semibold leading-tight">
              Datum der Einzahlung
            </th>
          </tr>
        </thead>
        <tbody>
          {% for r in col %}
            <tr class="{% if r.pay_date < today %}bg-gray-100{% elif r.is_holiday %}bg-red-100{% elif r.is_weekend %}bg-yellow-100{% endif %}">
              <td class="border border-[var(--text)] px-2 py-1 text-center">{{ r.stueckzins_de }}</td>
              <td class="border border-[var(--text)] px-2 py-1 text-center">{{ r.pay_date|date:"d. M y" }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% endfor %}
  </div>
{% endfor %}
