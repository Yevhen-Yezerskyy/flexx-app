{% extends "app_panel_tippgeber/base.html" %}
<!-- FILE: web/templates/app_panel_tippgeber/client_status.html  (обновлено — 2026-02-15)
     PURPOSE: Кнопки справа рядом: "Nachricht senden" + "Meine Kunden"; hidden birth_date отдаём как Y-m-d. -->
{% block panel_where %}
Meine Kunden
{% endblock %}
{% block nav_my_clients_class %}
text-[var(--accent)] font-semibold
{% endblock %}

{% block panel_content %}

<div class="flex items-center mb-10 mt-2">
  <div class="text-2xl">Status</div>
  <div class="flex-1"></div>

  <a href="{% url 'panel_tippgeber_my_clients' %}"
     class="w-48 rounded-md bg-gray-50 border-2 border-white text-[var(--text)] py-3 hover:brightness-95 transition font-semibold text-center flex items-center justify-center">
    Zurück
  </a>
</div>

{% if state.err %}
  <div class="mb-6 bg-white border border-red-400 rounded-md px-7 py-4">
    <div class="text-red-700 font-semibold">{{ state.err }}</div>
  </div>
{% endif %}

<div class="bg-white border border-[var(--accent)] rounded-md px-7 py-5 flex flex-col gap-4">

  {% if state.mode == "created" %}
    <div class="text-xl font-semibold text-[var(--text)]">Ihr Kunde wurde registriert.</div>
  {% else %}
    <div class="text-xl font-semibold text-[var(--text)]">Dieser Kunde mit dieser E-Mail existiert bereits.</div>
  {% endif %}

  <div class="bg-gray-50 rounded-md px-4 py-4">
    <div class="grid grid-cols-12 gap-2 text-[var(--text)] text-sm">
      <div class="col-span-3 font-semibold">E-Mail</div>
      <div class="col-span-9">{{ state.client_email }}</div>

      <div class="col-span-3 font-semibold">Name</div>
      <div class="col-span-9">{{ state.client_last_name }} {{ state.client_first_name }}</div>

      <div class="col-span-3 font-semibold">Firma</div>
      <div class="col-span-9">{{ state.client_company|default:"" }}</div>

      <div class="col-span-3 font-semibold">Geburtsdatum</div>
      <div class="col-span-9">
        {% if state.client_birth_date %}{{ state.client_birth_date|date:"d.m.Y" }}{% else %}&mdash;{% endif %}
      </div>

      <div class="col-span-3 font-semibold">Adresse</div>
      <div class="col-span-9">
        {{ state.client_street|default:"" }}{% if state.client_zip_code or state.client_city %}, {% endif %}
        {{ state.client_zip_code|default:"" }} {{ state.client_city|default:"" }}
      </div>

      <div class="col-span-3 font-semibold">Telefon</div>
      <div class="col-span-9">{{ state.client_phone|default:"" }}</div>
    </div>
  </div>

  {% if state.mode == "exists" and not state.client_is_mine %}
    <div class="flex justify-end gap-6 pt-2">
      <form method="post">
        {% csrf_token %}
        <input type="hidden" name="action" value="notify_conflict">
        <input type="hidden" name="client_email" value="{{ state.client_email }}">
        <input type="hidden" name="client_first_name" value="{{ state.client_first_name }}">
        <input type="hidden" name="client_last_name" value="{{ state.client_last_name }}">
        <input type="hidden" name="client_company" value="{{ state.client_company }}">
        <input type="hidden" name="client_birth_date" value="{% if state.client_birth_date %}{{ state.client_birth_date|date:'Y-m-d' }}{% endif %}">
        <input type="hidden" name="client_street" value="{{ state.client_street }}">
        <input type="hidden" name="client_zip_code" value="{{ state.client_zip_code }}">
        <input type="hidden" name="client_city" value="{{ state.client_city }}">
        <input type="hidden" name="client_phone" value="{{ state.client_phone }}">

        <button type="submit"
                class="rounded-md bg-[var(--accent)] text-white py-3 px-6 hover:brightness-110 transition font-semibold text-center">
          Nachricht an FleXXLager Administration senden
        </button>
      </form>

      <a href="{% url 'panel_tippgeber_my_clients' %}"
         class="w-48 rounded-md bg-gray-50 border-2 border-white text-[var(--text)] py-3 hover:brightness-95 transition font-semibold text-center flex items-center justify-center">
        Meine Kunden
      </a>
    </div>
  {% elif state.mode == "exists" and state.client_is_mine %}
    <div class="text-[var(--text)] font-semibold">Das ist Ihr Kunde.</div>
    <div class="flex justify-end gap-6 pt-2">
      <a href="{% url 'panel_tippgeber_my_clients' %}"
         class="w-48 rounded-md bg-gray-50 border-2 border-white text-[var(--text)] py-3 hover:brightness-95 transition font-semibold text-center flex items-center justify-center">
        Meine Kunden
      </a>
    </div>
  {% else %}
    <div class="flex justify-end gap-6 pt-2">
      <a href="{% url 'panel_tippgeber_my_clients' %}"
         class="w-48 rounded-md bg-gray-50 border-2 border-white text-[var(--text)] py-3 hover:brightness-95 transition font-semibold text-center flex items-center justify-center">
        Meine Kunden
      </a>
    </div>
  {% endif %}

</div>

{% endblock %}
